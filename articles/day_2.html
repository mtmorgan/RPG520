<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="RPG520">
<title>Day 2: Data Management, Visualization, and Analysis • RPG520</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Day 2: Data Management, Visualization, and Analysis">
<meta property="og:description" content="RPG520">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RPG520</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9010</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/day_1.html">Day 1: Introduction to the CCR, and to R</a>
    <a class="dropdown-item" href="../articles/day_2.html">Day 2: Data Management, Visualization, and Analysis</a>
    <a class="dropdown-item" href="../articles/day_3.html">Day 3: Single Cell Data; Survival Analysis</a>
    <a class="dropdown-item" href="../articles/z_appendix.html">Appendix</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mtmorgan/RPG520/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Day 2: Data Management, Visualization, and Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mtmorgan/RPG520/blob/HEAD/vignettes/day_2.Rmd" class="external-link"><code>vignettes/day_2.Rmd</code></a></small>
      <div class="d-none name"><code>day_2.Rmd</code></div>
    </div>

    
    
<ol style="list-style-type: decimal">
<li><p>Log on to <a href="https://ondemand.ccr.buffalo.edu" class="external-link uri">https://ondemand.ccr.buffalo.edu</a></p></li>
<li>
<p>Set up <em>RStudio</em> for today</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">'/projects/rpci/rplect/Rpg520/Rsetdirs.R'</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Let <em>RStudio</em> know about your new working directory</p>
<p><img src="images/rstudio-config.png"></p>
</li>
</ol>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>We use two case studies today. The studies are used to illustrate the
data manipulation and statistical analysis tasks that one might expect
in day-to-day wet- or dry-lab work in computational oncology.</p>
<p>We will use functions from the <a href="https://CRAN.R-project.org/package=dplyr" class="external-link">dplyr</a> package to
manage our data. <a href="https://CRAN.R-project.org/package=dplyr" class="external-link">dplyr</a> is is a key
package in a particular approach to data management in <em>R</em> called
the ‘tidyverse’. Tidy analysis uses a standard data structure (a
<code>tibble</code>) and relatively small number functions to provide an
effective way to accomplish many tasks.</p>
<p>Start by loading the <a href="https://CRAN.R-project.org/package=dplyr" class="external-link">dplyr</a> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>Functions for ‘tidy’ data management include:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> – filter data to contain specific rows.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> – select a subset of columns.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> – change or add columns.</li>
</ul>
<p>Example functions to summarize data:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count()</a></code> – simple count of entries in each column.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code> – e.g., <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> or
<code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var()</a></code>iance of one or more columns.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> – summarize data by group.</li>
</ul>
<p><a href="https://CRAN.R-project.org/package=tidyr" class="external-link">tidyr</a> and
other packages complement basic functionality</p>
<ul>
<li>
<code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">tidyr::pivot_wider()</a></code> – change a ‘long’ table to a
‘wide’ table. See example below.</li>
</ul>
<p>We will use the <a href="https://CRAN.R-project.org/package=readr" class="external-link">readr</a> package to
read data from disk into <em>R</em>.</p>
<p><a href="https://CRAN.R-project.org/package=tidyr" class="external-link">tidyr</a> and <a href="https://CRAN.R-project.org/package=readr" class="external-link">readr</a> are used less
commonly, so we do not load them into our <em>R</em> session yet.</p>
<p>For visualization, we use <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">ggplot2</a>; details
are provided below.</p>
<p>Finally, for statistical functions we use the ‘stats’ package
distributed with <em>R</em>.</p>
</div>
<div class="section level2">
<h2 id="us-cdc-behavioral-risk-factor-surveillance-system-survey-data">US CDC Behavioral Risk Factor Surveillance System survey data<a class="anchor" aria-label="anchor" href="#us-cdc-behavioral-risk-factor-surveillance-system-survey-data"></a>
</h2>
<p>We use data from the US Center for Disease Control’s Behavioral Risk
Factor Surveillance System (<a href="http://www.cdc.gov/brfss/" class="external-link">BRFSS</a>) annual survey. Check out the
web page for a little more information. We are using a small subset of
this data, including a random sample of 20000 observations from each of
1990 and 2010.</p>
<div class="section level3">
<h3 id="data-input">Data input<a class="anchor" aria-label="anchor" href="#data-input"></a>
</h3>
<p>Use <code><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose()</a></code> to find the ‘BRFSS-subset.csv’ file on
the CCR file system.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss_file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># look for 'Rpg520/week-04/extdata/BRFSS-subset.csv'</span></span></code></pre></div>
<p>Take a peak at the data using the <code><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines()</a></code> function
to read the first 3 lines of data, and <code>cat("\n")</code> to print
the result to the terminal</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">brfss_file_path</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span>sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## "Age","Weight","Sex","Height","Year"</span></span>
<span><span class="co">## 31,48.9879760010809,"Female",157.48,"1990"</span></span>
<span><span class="co">## 57,81.6466266684681,"Female",157.48,"1990"</span></span></code></pre></div>
<p>The file is a ‘comma-separated value’ file. These files can be
created by, for instance, using Excel’s ‘Export’ menu. The first line
consists of column headers, separated by a comma. Subsequent lines
represent rows of data, again with a comma separating columns.</p>
<p>Read the entire dataset into <em>R</em> with the command
<code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code>. Assign the data to a variable
<code>brfss</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">brfss_file_path</span><span class="op">)</span></span>
<span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">20000</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">5</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (1): Sex</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (4): Age, Weight, Height, Year</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="va">brfss</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 20,000 × 5</span></span></span>
<span><span class="co">##      Age Weight Sex    Height  Year</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>    31   49.0 Female   157.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>    57   81.6 Female   157.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    43   80.3 Male     178.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    72   70.3 Male     170.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>    31   49.9 Female   155.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>    58   54.4 Female   155.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>    45   69.9 Male     173.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>    37   68.0 Male     180.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>    33   65.8 Female   170.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    75   70.8 Female   152.  <span style="text-decoration: underline;">1</span>990</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 19,990 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="initial-cleaning">Initial cleaning<a class="anchor" aria-label="anchor" href="#initial-cleaning"></a>
</h3>
<p>The data are pretty simple, but two small changes will make it more
useful. Both ‘Sex’ and ‘Year’ are really <code>factor</code> values
(each can only take on specific levels, ‘Female’ and ‘Male’ for ‘Sex’,
and ‘1990’ and ‘2010’ for ‘Year’).</p>
<div class="section level4">
<h4 id="mutate">Mutate<a class="anchor" aria-label="anchor" href="#mutate"></a>
</h4>
<p>A factor can be created from an ordinary vector <code>x</code> with
code like the following:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Female"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">x</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] Male   Female Female &lt;NA&gt;  </span></span>
<span><span class="co">## Levels: Female Male</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2010</span>, <span class="fl">1991</span>, <span class="fl">1990</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">y</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1990"</span>, <span class="st">"2010"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 2010 &lt;NA&gt; 1990 &lt;NA&gt;</span></span>
<span><span class="co">## Levels: 1990 2010</span></span></code></pre></div>
<p>Use the dplyr <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> function to change ‘Sex’ and
‘Year’ to factors.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Sex</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Year</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1990"</span>, <span class="st">"2010"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 20,000 × 5</span></span></span>
<span><span class="co">##      Age Weight Sex    Height Year </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>    31   49.0 Female   157. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>    57   81.6 Female   157. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    43   80.3 Male     178. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    72   70.3 Male     170. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>    31   49.9 Female   155. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>    58   54.4 Female   155. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>    45   69.9 Male     173. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>    37   68.0 Male     180. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>    33   65.8 Female   170. 1990 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    75   70.8 Female   152. 1990 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 19,990 more rows</span></span></span></code></pre></div>
<p>That looks like it’s working, save the updated data set</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Sex</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Year</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1990"</span>, <span class="st">"2010"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="data-exploration">Data exploration<a class="anchor" aria-label="anchor" href="#data-exploration"></a>
</h3>
<p>A good place to start with an analysis is basic data exploration.
Perhaps the most straight-forward thing to do is count the number of
observations in each year.</p>
<div class="section level4">
<h4 id="count">Count<a class="anchor" aria-label="anchor" href="#count"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   Year      n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1990  <span style="text-decoration: underline;">10</span>000</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2010  <span style="text-decoration: underline;">10</span>000</span></span></code></pre></div>
<p>The data has been chosen so that each year has the same number of
individuals. What about the number of females and males in each year?
This is determined by responses to the survey, reflecting the relative
number of males and females in the population, or at least responding to
the survey.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   Sex        n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Female <span style="text-decoration: underline;">12</span>039</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Male    <span style="text-decoration: underline;">7</span>961</span></span></code></pre></div>
<p>What about the number of each sex in each year? Use
<code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count()</a></code> with two (or more) column names</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Sex</span>, <span class="va">Year</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">##   Sex    Year      n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Female 1990   <span style="text-decoration: underline;">5</span>718</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Female 2010   <span style="text-decoration: underline;">6</span>321</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Male   1990   <span style="text-decoration: underline;">4</span>282</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Male   2010   <span style="text-decoration: underline;">3</span>679</span></span></code></pre></div>
<p>It seems like there are more Female respondents in 2010 than in 1990.
Use <a href="https://CRAN.R-project.org/package=tidyr" class="external-link">tidyr</a>‘s
function <code>pivot_wider()</code> (remember to look at the help page
<code>?pivot_wider</code> for details on how this function works) to
pivot the ’Sex’ column entries to column names.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Sex</span>, <span class="va">Year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"Sex"</span>, values_from <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   Year  Female  Male</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1990    <span style="text-decoration: underline;">5</span>718  <span style="text-decoration: underline;">4</span>282</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2010    <span style="text-decoration: underline;">6</span>321  <span style="text-decoration: underline;">3</span>679</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="summarize">Summarize<a class="anchor" aria-label="anchor" href="#summarize"></a>
</h4>
<p>We used <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">tidyr::pivot_wider()</a></code> instead of just
<code>pivot_wider()</code>. This notation means ’use the <a href="https://CRAN.R-project.org/package=tidyr" class="external-link">tidyr</a> package, and a
function in that package called <code>pivot_wider()</code>. This
notation to avoid conflicts if two packages have a function named
<code>pivot_wider()</code>; it also has additional benefits related to
managing <em>R</em>’s <code>.GlobalEnv</code>, but that is a more
advanced topic.</p>
<p>Use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code> for summaries more complicated than
simple counts</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>        avg_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        ave_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Weight</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        ave_ht <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Height</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   avg_age ave_wt ave_ht</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    51.0   75.4   169.</span></span></code></pre></div>
<p>Nothing too exciting here, except to perhaps note the use of metric
system Weight (kg) and Height (cm).</p>
<p>The function <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> calculates the average of the
corresponding column. <code>na.rm = TRUE</code> tells the function to
remove <code>NA</code> (missing) values before calculating the mean.
This is kind of interesting. Suppose one had a vector and calculated the
mean</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## [1] 3</span></span></code></pre></div>
<p>No surprises. What if one of the values in <code>x</code> were
missing? The logic used by <em>R</em> is that the missing value could be
<em>any</em> number, so the mean could be <em>anything</em> – if there’s
an unknown value, then the mean must also be unknown!</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## [1] NA</span></span></code></pre></div>
<p>Often we would like to calculate the mean after removing the unknown
values, and this is what the <code>na.rm = TRUE</code> argument does</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## [1] 2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="group">Group<a class="anchor" aria-label="anchor" href="#group"></a>
</h4>
<p>Back to our data exploration, we might expect the average age,
weight, and height to be different between Female and Male respondents,
and perhaps also between years. Use <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> to calculate
summaries by Sex and Year</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Sex</span>, <span class="va">Year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>        avg_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        ave_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Weight</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        ave_ht <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Height</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">## `summarise()` has grouped output by 'Sex'. You can override using the `.groups`</span></span>
<span><span class="co">## argument.</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   Sex [2]</span></span></span>
<span><span class="co">##   Sex    Year  avg_age ave_wt ave_ht</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Female 1990     46.2   64.8   163.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Female 2010     57.1   73.0   163.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Male   1990     43.9   81.2   178.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Male   2010     56.2   88.8   178.</span></span></code></pre></div>
<p>This shows some interesting aspects of the data. Males are on average
15cm taller than females; there is no difference in average height
between years.</p>
<p>The average age of both Female and Male respondents is greater in
2010 than in 1990. This likely reflects changing demographics, as the
‘baby boom’ cohort ages. Note that the average Female age changes by
about 10.9 years, whereas the average Male age changes by about 12.3
years; perhaps this reflects different life expectancy of males and
females.</p>
<p>Also interesting is that the average weight changes, by about 8.2 kg
(18 lbs) for Female respondents, 7.6 kg (16.7 lbs) for Males. This could
be because people in general have become heavier, or that older people
are heavier than younger people (or for other reasons not captured in
the data).</p>
</div>
<div class="section level4">
<h4 id="filter">Filter<a class="anchor" aria-label="anchor" href="#filter"></a>
</h4>
<p>Use <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> to create a subset of the data containing
only 2010 respondents, and another subset containing only Male
respondents.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss_2010</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">==</span> <span class="st">"2010"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">brfss_male</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">brfss</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="st">"Male"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="visual-exploration">Visual exploration<a class="anchor" aria-label="anchor" href="#visual-exploration"></a>
</h3>
<p>We will use the <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">ggplot2</a> package to
visually explore our data. We use several functions from this package,
so load it into our <em>R</em> session.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p><a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">ggplot2</a>
constructs plots by adding layers. Layers have different roles. The plot
starts with the specification of the data set to be plotted…</p>
<div class="section level4">
<h4 id="aesthetics-geometries-box-plot-histogram-density-plot">Aesthetics &amp; geometries: box plot, histogram, density plot<a class="anchor" aria-label="anchor" href="#aesthetics-geometries-box-plot-histogram-density-plot"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_2010</span><span class="op">)</span></span></code></pre></div>
<p>…and then <em>adds</em> the ‘aesthetics’ (columns to be used for X
and Y axes, how to color points, etc)</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_2010</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sex</span>, y <span class="op">=</span> <span class="va">Weight</span><span class="op">)</span></span></code></pre></div>
<p>…and finally one or more ‘geometries’ (‘geom’) that describe the
geometric relationship between the x and y aesthetics. One geom is
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot()</a></code>, which draws a box-and-whiskers plot.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_2010</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sex</span>, y <span class="op">=</span> <span class="va">Weight</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Warning: Removed 395 rows containing non-finite values</span></span>
<span><span class="co">## (`stat_boxplot()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>The bar in the figure is the median weight, the box represents upper
and lower quartile of the data, the whiskers extend to 1.5 times the
inter-quartile range. Points outside the whiskers represent potential
outliers. The figure shows the difference in Female and Male weights, as
well as a skew in the weight distribution of both Female and Male
respondents.</p>
<p>Another way to view this sort of data is as a histogram…</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss_2010</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="st">"Male"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Weight</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">## Warning: Removed 49 rows containing non-finite values (`stat_bin()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>… or when comparing distributions as a density plot</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_2010</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Weight</span>, color <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Warning: Removed 395 rows containing non-finite values</span></span>
<span><span class="co">## (`stat_density()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>For subsequent work, note that log-transformed Weight reduces the
most extreme values so the distribution is more Normal.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_2010</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Warning: Removed 395 rows containing non-finite values</span></span>
<span><span class="co">## (`stat_density()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="scatter-plots">Scatter plots<a class="anchor" aria-label="anchor" href="#scatter-plots"></a>
</h4>
<p>Presumably taller people are heavier than shorter people. Replace
‘Sex’ with ‘Height’ in <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code>, and replace
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot()</a></code> with <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> to generate a
scatter plot showing this relationship</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_2010</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span>, y <span class="op">=</span> <span class="va">Weight</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Warning: Removed 450 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>Yes there looks like a relationship. Add
<code>geom_smooth(method = "lm")</code> to fit a smoothed relationship
to the points; <code>method = "lm"</code> indicates that the smoothed
line should be a linear regression.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_2010</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span>, y <span class="op">=</span> <span class="va">Weight</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">## Warning: Removed 450 rows containing non-finite values</span></span>
<span><span class="co">## (`stat_smooth()`).</span></span>
<span><span class="co">## Warning: Removed 450 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>The relationship between height and weight likely depends on sex. Add
<code>color = Sex</code> to the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> argument, so each
geom (both points and smoothed line) is colored by Sex.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_2010</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span>, y <span class="op">=</span> <span class="va">Weight</span>, color <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">## Warning: Removed 450 rows containing non-finite values</span></span>
<span><span class="co">## (`stat_smooth()`).</span></span>
<span><span class="co">## Warning: Removed 450 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>The lines cover the range of values for each sex; the relationship
between height and weight appears slightly steeper for males than
females.</p>
<p>Has the relationship between height and weight of males changed
between 1990 and 2010? Change the dataset to <code>brfss_male</code>,
color by <code>Year</code>, and add a title to the plot so that we know
a little bit more about the relationship. Also, explore a data
transformation by using the log of weight</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_male</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">Year</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"BRFSS Male Subset"</span><span class="op">)</span></span>
<span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">## Warning: Removed 104 rows containing non-finite values</span></span>
<span><span class="co">## (`stat_smooth()`).</span></span>
<span><span class="co">## Warning: Removed 104 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>The figure suggests that 2010 males are heavier than 1990 males at
all heights, and hints that the relationship between weight and height
is steeper in 2010; a formal statistical analysis is required for
further confidence.</p>
</div>
</div>
<div class="section level3">
<h3 id="statistical-analysis">Statistical analysis<a class="anchor" aria-label="anchor" href="#statistical-analysis"></a>
</h3>
<p>This section illustrates basic statistical tests; it would be
interesting to sit down with a statistician to discuss the subtleties of
a more correct analysis.</p>
<div class="section level4">
<h4 id="difference-between-groups">Difference between groups<a class="anchor" aria-label="anchor" href="#difference-between-groups"></a>
</h4>
<p>Here is a partial summary of the <code>brfss_2010</code> data
subset</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss_2010</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>        n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        ave_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        ave_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Weight</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        ave_ht <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Height</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##   Sex        n ave_age ave_wt ave_ht</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Female  <span style="text-decoration: underline;">6</span>321    57.1   73.0   163.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Male    <span style="text-decoration: underline;">3</span>679    56.2   88.8   178.</span></span></code></pre></div>
<p>Is there statistical support for the small difference between average
ages of Female and Male respondents?</p>
<p>Use <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> to compare two groups. After studying the
help page <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">?t.test</a></code>, we use the ‘formula’ notation to test
for differences in Age as a function of Sex, <code>Age ~ Sex</code>,
using the subset <code>brfss_2010</code> as the data source.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">Age</span> <span class="op">~</span> <span class="va">Sex</span>, <span class="va">brfss_2010</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  Age by Sex</span></span>
<span><span class="co">## t = 2.4497, df = 7768.7, p-value = 0.01432</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group Female and group Male is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.1674909 1.5091167</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean in group Female   mean in group Male </span></span>
<span><span class="co">##             57.08824             56.24993</span></span></code></pre></div>
<p>The summary reports (at the bottom) mean ages of Male and Female
respondents consistent with our own calculations, so we know we have not
made some kind of serious blunder in formulating the test. The
<em>t</em>-statistic of 2.4497162, with P-value 0.0143188 is
significant.</p>
<p>What about differences in Male Weight between 1990 and 2010?</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">~</span> <span class="va">Year</span>, <span class="va">brfss_male</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  Weight by Year</span></span>
<span><span class="co">## t = -20.751, df = 6549.4, p-value &lt; 2.2e-16</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group 1990 and group 2010 is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -8.390845 -6.942327</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean in group 1990 mean in group 2010 </span></span>
<span><span class="co">##           81.17999           88.84657</span></span></code></pre></div>
<p>Conversation with a statistician might make us concerned about
whether assumptions of the <em>t</em>-test are fully satisfied, e.g.,
the data are supposed to be normally distributed, but as we saw in the
box plots weights are skewed. We could try to transform the data (formal
approaches to assess appropriateness of data transformations are
available), e.g., by using log Weight</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span> <span class="op">~</span> <span class="va">Year</span>, <span class="va">brfss_male</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  log10(Weight) by Year</span></span>
<span><span class="co">## t = -20.202, df = 6985.4, p-value &lt; 2.2e-16</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group 1990 and group 2010 is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.03971348 -0.03268805</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean in group 1990 mean in group 2010 </span></span>
<span><span class="co">##           1.903711           1.939912</span></span></code></pre></div>
<p>Or we might use a statistic like the Wilcoxon test that makes fewer
assumptions about the underlying statistical distribution.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">~</span> <span class="va">Year</span>, <span class="va">brfss_male</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Wilcoxon rank sum test with continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  Weight by Year</span></span>
<span><span class="co">## W = 5754766, p-value &lt; 2.2e-16</span></span>
<span><span class="co">## alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<p>Regardless of the details of the analysis, the difference in Male
Weight between 1990 and 2010 is highly significant.</p>
</div>
<div class="section level4">
<h4 id="linear-regression">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h4>
<p>The ‘BRFSS Male Subset’ figure shows linear relations between the
square root of Weight and Height in each year.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">brfss_male</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">Year</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"BRFSS Male Subset"</span><span class="op">)</span></span>
<span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">## Warning: Removed 104 rows containing non-finite values</span></span>
<span><span class="co">## (`stat_smooth()`).</span></span>
<span><span class="co">## Warning: Removed 104 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>How would we calculate this regression, and assess its significance?
We focus on Male 2010 data.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brfss_male_2010</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">brfss_male</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">==</span> <span class="st">"2010"</span><span class="op">)</span></span></code></pre></div>
<p>The answer is to fit a linear regression to the data. In <em>R</em>,
this is done by fitting a linear model (<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>) and then
summarizing the result.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## fit the linear model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span> <span class="op">~</span> <span class="va">Height</span>, <span class="va">brfss_male_2010</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## summarize the fit, including a statistical assessment of the fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = log10(Weight) ~ Height, data = brfss_male_2010)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.34142 -0.05229 -0.00645  0.04462  0.45706 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 1.0767107  0.0309565   34.78   &lt;2e-16 ***</span></span>
<span><span class="co">## Height      0.0048498  0.0001737   27.91   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.07824 on 3617 degrees of freedom</span></span>
<span><span class="co">##   (60 observations deleted due to missingness)</span></span>
<span><span class="co">## Multiple R-squared:  0.1772, Adjusted R-squared:  0.177 </span></span>
<span><span class="co">## F-statistic: 779.2 on 1 and 3617 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The ANOVA table shows that the relationship is highly significant.
The ‘Adjusted R-squared’ value indicates that about 17% of the variation
in Weight is accounted for by Height. The estimated coefficient
associated with Height is the slope of the line, indicating that the
square root of Weight increases by about 0.0048498 for every increase in
Height of 1 cm.</p>
<p>As an aside, one might hope that <code>plot(fit)</code> would plot
the regression line. Actually, it creates a series of diagnostic plots
that help us assess the appropriateness of our choice of a linear model
for describing this data.</p>
<p>More advanced analysis using <em>R</em> to test, e.g., for
differences in the intercept or slope of the regression in 1990 versus
2010 are straight-forward to implement, but require more sophisticated
statistical understanding.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="acute-lymphocytic-leukemia-all">Acute Lymphocytic Leukemia (ALL)<a class="anchor" aria-label="anchor" href="#acute-lymphocytic-leukemia-all"></a>
</h2>
<p>This data set is from an old microarray experiment investigating
acute lymphocytic leukemia (ALL) (PMID <a href="https://doi.org/10.1182/blood-2003-09-3243" class="external-link">14684422</a>, <a href="https://doi.org/10.1158/1078-0432.ccr-04-2165" class="external-link">16243790</a>; the
data has been extracted from the <a href="https://bioconductor.org/packages/ALL" class="external-link">ALL</a>
<em>Bioconductor</em> package). We focus on phenotypes of 128
patients.</p>
<div class="section level3">
<h3 id="data-input-1">Data input<a class="anchor" aria-label="anchor" href="#data-input-1"></a>
</h3>
<p>Use <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code> to input the ‘ALL.csv’ file.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># look for 'Rpg520/week-04/extdata/all.csv'</span></span>
<span><span class="va">all</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">all_file</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">all</span><span class="op">)</span></span>
<span><span class="co">## Rows: 128</span></span>
<span><span class="co">## Columns: 21</span></span>
<span><span class="co">## $ cod              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1005", "1010", "3002", "4006", "4007", "4008", "4010…</span></span>
<span><span class="co">## $ diagnosis        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "5/21/1997", "3/29/2000", "6/24/1998", "7/17/1997", "…</span></span>
<span><span class="co">## $ sex              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "M", "M", "F", "M", "M", "M", "F", "M", "M", "M", "M"…</span></span>
<span><span class="co">## $ age              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 53, 19, 52, 38, 57, 17, 18, 16, 15, 40, 33, 55, 5, 18…</span></span>
<span><span class="co">## $ BT               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "B2", "B2", "B4", "B1", "B2", "B1", "B1", "B1", "B2",…</span></span>
<span><span class="co">## $ remission        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "CR", "CR", "CR", "CR", "CR", "CR", "CR", "CR", "CR",…</span></span>
<span><span class="co">## $ CR               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "CR", "CR", "CR", "CR", "CR", "CR", "CR", "CR", "CR",…</span></span>
<span><span class="co">## $ date.cr          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "8/6/1997", "6/27/2000", "8/17/1998", "9/8/1997", "9/…</span></span>
<span><span class="co">## $ `t(4;11)`        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, NA, TRUE, FALSE, FALSE, FALSE, FALSE, F…</span></span>
<span><span class="co">## $ `t(9;22)`        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE, FALSE, NA, FALSE, FALSE, FALSE, FALSE, FALSE, F…</span></span>
<span><span class="co">## $ cyto.normal      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, NA, FALSE, FALSE, FALSE, FALSE, FALSE, …</span></span>
<span><span class="co">## $ citog            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "t(9;22)", "simple alt.", NA, "t(4;11)", "del(6q)", "…</span></span>
<span><span class="co">## $ mol.biol         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "BCR/ABL", "NEG", "BCR/ABL", "ALL1/AF4", "NEG", "NEG"…</span></span>
<span><span class="co">## $ `fusion protein` <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "p210", NA, "p190", NA, NA, NA, NA, NA, NA, "p190", "…</span></span>
<span><span class="co">## $ mdr              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NEG", "POS", "NEG", "NEG", "NEG", "NEG", "POS", "NEG…</span></span>
<span><span class="co">## $ kinet            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "dyploid", "dyploid", "dyploid", "dyploid", "dyploid"…</span></span>
<span><span class="co">## $ ccr              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS…</span></span>
<span><span class="co">## $ relapse          <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE…</span></span>
<span><span class="co">## $ transplant       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</span></span>
<span><span class="co">## $ f.u              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "BMT / DEATH IN CR", "REL", "REL", "REL", "REL", "REL…</span></span>
<span><span class="co">## $ `date last seen` <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, "8/28/2000", "10/15/1999", "1/23/1998", "11/4/199…</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploration-cleaning">Exploration &amp; cleaning<a class="anchor" aria-label="anchor" href="#exploration-cleaning"></a>
</h3>
<p>For simplicity we focus on the following columns:</p>
<ul>
<li>‘cod’ is a unique identifier</li>
<li>‘sex’. We will recode this to a factor with levels ‘Female’ and
‘Male’, so that there is no ambiguity about its meaning.</li>
<li>‘age’.</li>
<li>‘BT’ represents B- or T- cell status. It is too fine-grained, so we
will recode this to a new variable ‘BorT’.</li>
<li>‘mol.biol’ summarizes status with respect to chromosomal status. We
will filter the data to contain only patients with values ‘BCR/ABL’ (the
classic BCR / ABL inversion) or ‘NEG’ (no chromosomal changes). We will
recode the result as a factor with levels ‘BCR/ABL’ and ‘NEG’.</li>
</ul>
<div class="section level4">
<h4 id="select">
<code>select()</code><a class="anchor" aria-label="anchor" href="#select"></a>
</h4>
<p>Use <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> to select just the columns of interest.
Re-assign the result to <code>all</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">all</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cod</span>, <span class="va">sex</span>, <span class="va">age</span>, <span class="va">BT</span>, <span class="va">mol.biol</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ifelse-and-factor">
<code>ifelse()</code> and <code>factor()</code><a class="anchor" aria-label="anchor" href="#ifelse-and-factor"></a>
</h4>
<p>‘sex’ is currently a character vector with two values ‘F’ and ‘M’, as
well as missing values</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">##   sex       n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> F        42</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> M        83</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> <span style="color: #BB0000;">NA</span>        3</span></span></code></pre></div>
<p>We can remove individuals whose sex is unknown using
<code>filter(!is.na(sex))</code>. Use <code><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse()</a></code> to translate
‘F’ and ‘M’ to ‘Female’ and ‘Male’, and then <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> so
that this column is a factor</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all</span>  <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"F"</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 125 × 5</span></span></span>
<span><span class="co">##    cod   sex      age BT    mol.biol</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1005  Male      53 B2    BCR/ABL </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 1010  Male      19 B2    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 3002  Female    52 B4    BCR/ABL </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 4006  Male      38 B1    ALL1/AF4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 4007  Male      57 B2    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 4008  Male      17 B1    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 4010  Female    18 B1    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 4016  Male      16 B1    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 6002  Male      15 B2    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 8001  Male      40 B2    BCR/ABL </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 115 more rows</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="startswith">
<code>startsWith()</code><a class="anchor" aria-label="anchor" href="#startswith"></a>
</h4>
<p>The <code>BT</code> column describes whether individuals have B- or
T-cell ALL. There are several different grades of each.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">BT</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 2</span></span></span>
<span><span class="co">##    BT        n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> B         5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> B1       19</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> B2       36</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> B3       23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> B4       12</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> T         5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> T1        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> T2       15</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> T3       10</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> T4        2</span></span></code></pre></div>
<p>We are interested in simplifying this to just two values, ‘B’ or ‘T’,
based on the first letter of each vector element. The
<code><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith()</a></code> function returns <code>TRUE</code> each time
an element of the first argument starts with the second argument.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"B1"</span>, <span class="st">"T"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="co">## [1]  TRUE  TRUE FALSE</span></span></code></pre></div>
<p>We can combine this with <code><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse()</a></code> and
<code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> to mutate <code>BT</code></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        BT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="va">BT</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="st">"B"</span>, <span class="st">"T"</span><span class="op">)</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"T"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 128 × 5</span></span></span>
<span><span class="co">##    cod   sex     age BT    mol.biol</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1005  M        53 B     BCR/ABL </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 1010  M        19 B     NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 3002  F        52 B     BCR/ABL </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 4006  M        38 B     ALL1/AF4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 4007  M        57 B     NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 4008  M        17 B     NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 4010  F        18 B     NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 4016  M        16 B     NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 6002  M        15 B     NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 8001  M        40 B     BCR/ABL </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 118 more rows</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="in">
<code>%in%</code><a class="anchor" aria-label="anchor" href="#in"></a>
</h4>
<p>‘mol.biol’ is also a character vector with several different
values.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">mol.biol</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">##   mol.biol     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> ALL1/AF4    10</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> BCR/ABL     37</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> E2A/PBX1     5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> NEG         74</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> NUP-98       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> p15/p16      1</span></span></code></pre></div>
<p>We will filter <code>all</code> to only include ‘BCR/ABL’ or ‘NEG’
samples using <code>%in%</code>. <code>%in%</code> is an ‘infix’
operator (like <code>~</code>) with a left-hand side and a right-hand
side. The left-hand side is a vector of values that we are interested
in. The right-hand side is also a vector, and represents a
(mathematical) ‘set’ of values. <code>%in%</code> asks, for each element
of the left-hand size, if the element is a member of the set on the
right hand side.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## [1] FALSE  TRUE FALSE FALSE  TRUE</span></span></code></pre></div>
<p>Filtering the <code>all</code> dataset is accomplished with</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mol.biol</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BCR/ABL"</span>, <span class="st">"NEG"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 111 × 5</span></span></span>
<span><span class="co">##    cod   sex     age BT    mol.biol</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1005  M        53 B2    BCR/ABL </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 1010  M        19 B2    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 3002  F        52 B4    BCR/ABL </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 4007  M        57 B2    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 4008  M        17 B1    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 4010  F        18 B1    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 4016  M        16 B1    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 6002  M        15 B2    NEG     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 8001  M        40 B2    BCR/ABL </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 8011  M        33 B3    BCR/ABL </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 101 more rows</span></span></span></code></pre></div>
<p>Re-coding the filtered values of ‘mol.biol’ uses
<code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> in a way that we have already seen with ‘sex’.</p>
</div>
<div class="section level4">
<h4 id="data-cleaning-pipeline">Data cleaning pipeline<a class="anchor" aria-label="anchor" href="#data-cleaning-pipeline"></a>
</h4>
<p>Putting these filtering and re-coding steps together, our initial
cleaning results in</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_subset</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">all</span> <span class="op">|&gt;</span></span>
<span>    <span class="co">## columns of interest</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cod</span>, <span class="va">sex</span>, <span class="va">age</span>, <span class="va">BT</span>, <span class="va">mol.biol</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co">## rows of interest</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>        <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>,</span>
<span>        <span class="va">mol.biol</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BCR/ABL"</span>, <span class="st">"NEG"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co">## re-coding sex, mol.bio, BT</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"F"</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        BT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="va">BT</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="st">"B"</span>, <span class="st">"T"</span><span class="op">)</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"T"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        mol.biol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mol.biol</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BCR/ABL"</span>, <span class="st">"NEG"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="data-exploration-1">Data exploration<a class="anchor" aria-label="anchor" href="#data-exploration-1"></a>
</h3>
<p>A basic characterize of our subset might group by sex and summarize
the number and average age of each group.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_subset</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>        n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        av_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   sex        n av_age</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Female    35   34.8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Male      74   30.9</span></span></code></pre></div>
<p>There are about twice as many Male as Female samples; the average age
of Female samples is about 4 years older than Male samples.</p>
<p>We can visualize the distribution of ages in several ways, as
illustrated in the previous case study. Here we create a box plot with
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot()</a></code>, then overlay the individual points using
<code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter()</a></code> (this geom displays each point but with a bit
of ‘jitter’ away from its actual value – instead of being plotted
exactly on the ‘Female’ or ‘Male’ line, the points are offset a random
amount).</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_subset</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sex</span>, y <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></span>
<span><span class="co">## Warning: Removed 2 rows containing non-finite values (`stat_boxplot()`).</span></span>
<span><span class="co">## Warning: Removed 2 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="day_2_files/figure-html/unnamed-chunk-55-1.png" width="700"></p>
<p>The following table counts the number of ‘BCR/ABL’ and ‘NEG’ among
‘Female’ and ‘Male’ samples; it seems like there is a disproportionate
number of ‘Male’ ‘NEG’ (chromosomally normal) individuals.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_subset</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">mol.biol</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"sex"</span>, values_from <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   mol.biol Female  Male</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> BCR/ABL      16    21</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> NEG          19    53</span></span></code></pre></div>
<p>Here is a similar tally of B- and T-cell ALL for ‘Female’ and ‘Male’
samples</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_subset</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">BT</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"sex"</span>, values_from <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   BT    Female  Male</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> B         28    50</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> T          7    24</span></span></code></pre></div>
<p>… and a count of ‘BT’ and ‘mol.biol’ by sex</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_subset</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">BT</span>, <span class="va">mol.biol</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"sex"</span>, values_from <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">##   BT    mol.biol Female  Male</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> B     BCR/ABL      16    21</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> B     NEG          12    29</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> T     NEG           7    24</span></span></code></pre></div>
<p>Note that there are not T-cell, BCR/ABL samples. Is this for
biological reasons, or is an artifact of the procedures used in data
collection? Does it limit or bias the statistical questions that can be
asked?</p>
</div>
<div class="section level3">
<h3 id="statistical-analysis-1">Statistical analysis<a class="anchor" aria-label="anchor" href="#statistical-analysis-1"></a>
</h3>
<p>A <em>t</em>-test indicates that the difference in Male and Female
age noted above is not statistically significant</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">sex</span>, <span class="va">all_subset</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  age by sex</span></span>
<span><span class="co">## t = 1.3901, df = 66.316, p-value = 0.1691</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group Female and group Male is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -1.687236  9.424537</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean in group Female   mean in group Male </span></span>
<span><span class="co">##             34.77143             30.90278</span></span></code></pre></div>
<p>We noted differences in the number ‘BCR/ABL’ and ‘NEG’ samples with
respect to <code>sex</code>. A Chi-squared test can be used to assess
whether these differences are statistically significant. Look at the
help page <code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">?chisq.test</a></code>. The idea is that the first argument
is a vector of observations of one variable (e.g.,
<code>mol.biol</code>) and the second argument is the second variable
(<code>sex</code>). Unlike <code>t.test</code>, there is no
<code>data=</code> argument, and no formula (<code>~</code>) interface.
In base <em>R</em> one might use <code>$</code> to access individual
columns of a tibble, so the test could be performed with</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">all_subset</span><span class="op">$</span><span class="va">mol.biol</span>, <span class="va">all_subset</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre></div>
<p>A convenient variation of this is to use the function
<code><a href="https://rdrr.io/r/base/with.html" class="external-link">with()</a></code>, which allows one to write the test as</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_subset</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">mol.biol</span>, <span class="va">sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test with Yates' continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  mol.biol and sex</span></span>
<span><span class="co">## X-squared = 2.4586, df = 1, p-value = 0.1169</span></span></code></pre></div>
<p>The P-value indicates that the differences in counts of ‘BCR/ABL’ and
‘NEG’ observed between ‘Female’ and ‘Male’ are not statistically
supported. A similar conclusion applies with <code>BT</code> and
<code>sex</code>.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_subset</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">BT</span>, <span class="va">sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test with Yates' continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  BT and sex</span></span>
<span><span class="co">## X-squared = 1.2454, df = 1, p-value = 0.2644</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<p>For reproducibility, I record the software versions used to create
this document</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] ggplot2_3.4.4 dplyr_1.1.4  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] sass_0.4.8        utf8_1.2.4        generics_0.1.3    tidyr_1.3.1      </span></span>
<span><span class="co">##  [5] lattice_0.21-9    stringi_1.8.3     hms_1.1.3         digest_0.6.34    </span></span>
<span><span class="co">##  [9] magrittr_2.0.3    evaluate_0.23     grid_4.3.2        fastmap_1.1.1    </span></span>
<span><span class="co">## [13] Matrix_1.6-1.1    jsonlite_1.8.8    mgcv_1.9-0        purrr_1.0.2      </span></span>
<span><span class="co">## [17] fansi_1.0.6       scales_1.3.0      textshaping_0.3.7 jquerylib_0.1.4  </span></span>
<span><span class="co">## [21] cli_3.6.2         rlang_1.1.3       crayon_1.5.2      splines_4.3.2    </span></span>
<span><span class="co">## [25] bit64_4.0.5       munsell_0.5.0     withr_3.0.0       cachem_1.0.8     </span></span>
<span><span class="co">## [29] yaml_2.3.8        tools_4.3.2       parallel_4.3.2    tzdb_0.4.0       </span></span>
<span><span class="co">## [33] memoise_2.0.1     colorspace_2.1-0  vctrs_0.6.5       R6_2.5.1         </span></span>
<span><span class="co">## [37] lifecycle_1.0.4   stringr_1.5.1     fs_1.6.3          bit_4.0.5        </span></span>
<span><span class="co">## [41] vroom_1.6.5       ragg_1.2.7        pkgconfig_2.0.3   desc_1.4.3       </span></span>
<span><span class="co">## [45] pkgdown_2.0.7     pillar_1.9.0      bslib_0.6.1       gtable_0.3.4     </span></span>
<span><span class="co">## [49] glue_1.7.0        systemfonts_1.0.5 highr_0.10        xfun_0.42        </span></span>
<span><span class="co">## [53] tibble_3.2.1      tidyselect_1.2.0  knitr_1.45        farver_2.1.1     </span></span>
<span><span class="co">## [57] nlme_3.1-163      htmltools_0.5.7   labeling_0.4.3    rmarkdown_2.25   </span></span>
<span><span class="co">## [61] readr_2.1.5       compiler_4.3.2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Morgan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
